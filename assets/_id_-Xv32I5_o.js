import{bX as C,ae as k,R as x,S as I,ad as w,G as q,Y as B,W as N,L as t,X as e,ag as c,aj as n,V as P,Z as u,aJ as Q,af as R,ai as $,bJ as E,O as F,an as O}from"./index-B456UOXX.js";import{c as j,b as A,u as D}from"./index.esm-BrHK9G6o.js";import{b as _}from"./route-block-B_A1xBdJ.js";import{V as J,a as l}from"./VRow-DtU87YMm.js";import{V as L}from"./VDivider-DdPK3Bj9.js";import{V as X}from"./VForm-ChY4pq-5.js";import{V as G}from"./VContainer-BTSruO4h.js";const M={class:"text-center"},T={class:"text-center"},U={__name:"[id]",setup(W){const{api:y,apiAuth:v}=O(),b=C(),d=k(),{t:r}=x(),p=I(),m=w(),s=q({_id:"",name:"",description:"",image:"",sell:!0});(async()=>{try{const{data:a}=await y.get("/product/"+b.params.id);s.value=a.result,document.title=s.value.name+" | 購物網站"}catch(a){console.log(a),d.push("/")}})();const V=j({quantity:A().typeError(r("product.addCartQuantityInvalid")).required(r("product.addCartQuantityInvalid")).positive(r("product.addCartQuantityInvalid")).integer(r("product.addCartQuantityInvalid"))}),{handleSubmit:h,isSubmitting:f}=D({validationSchema:V,initialValues:{quantity:1}}),S=h(async a=>{var i,g;if(!p.isLoggedIn){d.push("/login");return}try{const{data:o}=await v.patch("/user/cart",{product:s.value._id,quantity:a.quantity});p.cart=o.result,m({text:r("product.addCartSuccess"),snackbarProps:{color:"green"}})}catch(o){console.log(o),m({text:r("api."+(((g=(i=o==null?void 0:o.response)==null?void 0:i.data)==null?void 0:g.message)||"unknownError")),snackbarProps:{color:"red"}})}});return(a,i)=>(B(),N(F,null,[t(G,null,{default:e(()=>[t(J,null,{default:e(()=>[t(l,{cols:"12"},{default:e(()=>[c("h1",M,n(s.value.name),1)]),_:1}),t(L),t(l,{cols:"12",md:"6"},{default:e(()=>[t(P,{src:s.value.image},null,8,["src"])]),_:1}),t(l,{cols:"12",md:"6"},{default:e(()=>[c("p",null,n(s.value.description),1),t(X,{disabled:u(f),onSubmit:Q(u(S),["prevent"])},{default:e(()=>[t(R,{type:"submit","prepend-icon":"mdi-cart",loading:u(f)},{default:e(()=>[$(n(a.$t("product.addCart")),1)]),_:1},8,["loading"])]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1}),t(E,{"model-value":!s.value.sell,class:"align-center justify-center",scrim:"black",opacity:"0.8",persistent:""},{default:e(()=>[c("h1",T,n(a.$t("api.productNotOnSell")),1)]),_:1},8,["model-value"])],64))}};typeof _=="function"&&_(U);export{U as default};
