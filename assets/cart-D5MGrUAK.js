import{S as R,ae as S,ad as A,R as E,G as I,c as v,Y as n,$ as g,X as s,L as e,ag as h,aj as u,W as y,_ as q,O as C,af as d,ai as b,aR as z,V as D,ak as P,an as j}from"./index-Dqm6nmYD.js";import{b as w}from"./route-block-B_A1xBdJ.js";import{a as p,V as F}from"./VRow-Dy5e7ap_.js";import{V as x}from"./VDivider-6hrTf0jz.js";import{V as G}from"./VList-DYKTtGfg.js";import{V as O}from"./VContainer-5c1AGe4q.js";import{V as T}from"./VListItem-9gVX_VXe.js";const U={class:"text-center"},W={__name:"cart",setup(X){const{apiAuth:i}=j(),m=R(),B=S(),f=A(),{t:_}=E(),c=I([]),k=async()=>{try{const{data:a}=await i.get("/user/cart");c.value=a.result}catch(a){console.log(a)}};k();const $=v(()=>c.value.reduce((a,r)=>a+r.product.price*r.quantity,0)),L=v(()=>c.value.length>0&&c.value.every(a=>a.product.sell)),V=async(a,r)=>{var t,l;try{const{data:o}=await i.patch("/user/cart",{product:a,quantity:r});m.cart=o.result,k()}catch(o){console.log(o),f({text:_("api."+(((l=(t=o==null?void 0:o.response)==null?void 0:t.data)==null?void 0:l.message)||"unknownError")),snackbarProps:{color:"red"}})}},N=async()=>{var a,r;try{await i.post("/order"),m.cart=0,B.push("/order")}catch(t){console.log(t),f({text:_("api."+(((r=(a=t==null?void 0:t.response)==null?void 0:a.data)==null?void 0:r.message)||"unknownError")),snackbarProps:{color:"red"}})}};return(a,r)=>(n(),g(O,null,{default:s(()=>[e(F,null,{default:s(()=>[e(p,{cols:"12"},{default:s(()=>[h("h1",U,u(a.$t("nav.cart")),1)]),_:1}),e(x),e(p,{cols:"12"},{default:s(()=>[e(G,{lines:"two"},{default:s(()=>[(n(!0),y(C,null,q(c.value,(t,l)=>(n(),y(C,{key:t._id},[e(T,{title:t.product.name,subtitle:t.product.price,"active-class":"bg-red",active:!t.product.sell},{prepend:s(()=>[e(z,{rounded:"0"},{default:s(()=>[e(D,{src:t.product.image},null,8,["src"])]),_:2},1024)]),append:s(()=>[e(d,{color:"red",icon:"mdi-minus",size:"small",class:"mr-2",onClick:o=>V(t.product._id,-1)},null,8,["onClick"]),b(" "+u(t.quantity)+" ",1),e(d,{color:"green",icon:"mdi-plus",size:"small",class:"ml-2",onClick:o=>V(t.product._id,1)},null,8,["onClick"])]),_:2},1032,["title","subtitle","active"]),l<c.value.length-1?(n(),g(x,{key:0})):P("",!0)],64))),128))]),_:1})]),_:1}),e(p,{cols:"12",class:"text-center"},{default:s(()=>[h("p",null,u($.value),1),e(d,{color:"primary",disabled:!L.value,onClick:N},{default:s(()=>[b(u(a.$t("cart.checkout")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}))}};typeof w=="function"&&w(W);export{W as default};
