import{R as z,ad as P,aI as L,G as c,c as _,U as j,Y as D,W as G,L as l,X as o,ag as J,aj as d,af as b,ai as m,ah as K,aB as F,V as O,$ as W,ak as X,Z as n,aJ as Y,aA as Z,ax as H,ay as Q,az as ee,aK as ae,O as le,an as te,ac as oe}from"./index-Dqm6nmYD.js";import{c as re,a as R,d as se,u as ne,e as w}from"./index.esm-BnGeI45J.js";import{b as T}from"./route-block-B_A1xBdJ.js";import{V as ie,a as U}from"./VRow-Dy5e7ap_.js";import{V as ue}from"./VDivider-6hrTf0jz.js";import{V as de}from"./VDataTable-DsLpx_BK.js";import{V as pe}from"./VToolbar-DF5KR4WY.js";import{V as me}from"./VContainer-5c1AGe4q.js";import{V as ce}from"./VForm-BWysQBJk.js";import{V as fe}from"./VCheckbox-fetwUOGO.js";import{V as ge}from"./VTextarea-C2g8wVRG.js";import"./sort-C7hXrTYW.js";import"./VPagination-D8gw3AtD.js";import"./VList-DYKTtGfg.js";import"./VListItem-9gVX_VXe.js";import"./VMenu-m3QGsFPg.js";import"./VChip-DLt58BWP.js";const ve={class:"text-center"},Ve={__name:"page",setup(xe){const{t:r}=z(),{apiAuth:k}=te(),f=P(),g=L([]),y=c(""),q=_(()=>[{title:"ID",key:"_id",sortable:!0},{title:r("explore.image"),key:"image",sortable:!1},{title:r("explore.name"),key:"name",sortable:!0},{title:r("explore.description"),key:"description",sortable:!0},{title:r("explore.sell"),key:"sell",sortable:!0},{title:r("explore.createdAt"),key:"createdAt",sortable:!0},{title:r("explore.updatedAt"),key:"updatedAt",sortable:!0},{title:r("adminExplore.edit"),key:"edit",sortable:!1}]),h=async()=>{var a,t;try{const{data:u}=await k.get("/explore/all");g.push(...u.result)}catch(u){console.log(u),f({text:r("api."+(((t=(a=u==null?void 0:u.response)==null?void 0:a.data)==null?void 0:t.message)||"unknownError")),snackbarProps:{color:"red"}})}};h();const i=c({open:!1,id:""}),A=a=>{a&&(i.value.id=a._id,v.value.value=a.name,V.value.value=a.description,x.value.value=a.sell),i.value.open=!0},$=()=>{M(),i.value.id="",i.value.open=!1,C.value.deleteFileRecord()},B=re({name:R().required(r("api.exploreNameRequired")),description:R().required(r("api.exploreDescriptionRequired")),sell:se().required(r("api.exploreSellRequired"))}),{handleSubmit:I,isSubmitting:S,resetForm:M}=ne({validationSchema:B,initialValues:{name:"",description:"",category:"",sell:!1}}),v=w("name"),V=w("description"),x=w("sell"),C=c(null),p=c([]),E=c([]),N=I(async a=>{var t,u,e;if(!((t=p.value[0])!=null&&t.error)){if(i.value.id.length===0&&p.value.length===0){f({text:r("api.exploreImageRequired"),snackbarProps:{color:"red"}});return}try{const s=new FormData;s.append("name",a.name),s.append("description",a.description),s.append("sell",a.sell),p.value.length>0&&s.append("image",p.value[0].file),i.value.id.length>0?await k.patch("/explore/"+i.value.id,s):await k.post("/explore",s),g.splice(0,g.length),h(),f({text:r(i.value.id.length>0?"adminExplore.editSuccess":"adminExplore.newSuccess"),snackbarProps:{color:"green"}}),$()}catch(s){console.log(s),f({text:r("api."+(((e=(u=s==null?void 0:s.response)==null?void 0:u.data)==null?void 0:e.message)||"unknownError")),snackbarProps:{color:"red"}})}}});return(a,t)=>{const u=j("VueFileAgent");return D(),G(le,null,[l(me,null,{default:o(()=>[l(ie,null,{default:o(()=>[l(U,{cols:"12"},{default:o(()=>[J("h1",ve,d(a.$t("nav.adminExplore")),1)]),_:1}),l(ue),l(U,{cols:"12"},{default:o(()=>[l(de,{items:g,headers:q.value,search:y.value},{top:o(()=>[l(pe,null,{default:o(()=>[l(b,{onClick:t[0]||(t[0]=e=>A(null))},{default:o(()=>[m(d(a.$t("adminExplore.new")),1)]),_:1}),l(K),l(F,{modelValue:y.value,"onUpdate:modelValue":t[1]||(t[1]=e=>y.value=e),"prepend-inner-icon":"mdi-magnify",variant:"underlined"},null,8,["modelValue"])]),_:1})]),"item.image":o(({value:e})=>[l(O,{src:e,height:"50"},null,8,["src"])]),"item.sell":o(({value:e})=>[e?(D(),W(oe,{key:0,icon:"mdi-check"})):X("",!0)]),"item.createdAt":o(({value:e})=>[m(d(new Date(e).toLocaleString()),1)]),"item.updatedAt":o(({value:e})=>[m(d(new Date(e).toLocaleString()),1)]),"item.edit":o(({item:e})=>[l(b,{icon:"mdi-pencil",variant:"text",onClick:s=>A(e)},null,8,["onClick"])]),_:2},1032,["items","headers","search"])]),_:1})]),_:1})]),_:1}),l(ae,{modelValue:i.value.open,"onUpdate:modelValue":t[7]||(t[7]=e=>i.value.open=e),persistent:""},{default:o(()=>[l(ce,{disabled:n(S),onSubmit:Y(n(N),["prevent"])},{default:o(()=>[l(Z,null,{default:o(()=>[l(H,null,{default:o(()=>[m(d(a.$t(i.value.id?"adminExplore.edit":"adminExplore.new")),1)]),_:1}),l(Q,null,{default:o(()=>[l(F,{modelValue:n(v).value.value,"onUpdate:modelValue":t[2]||(t[2]=e=>n(v).value.value=e),label:a.$t("explore.name"),"error-messages":n(v).errorMessage.value},null,8,["modelValue","label","error-messages"]),l(fe,{modelValue:n(x).value.value,"onUpdate:modelValue":t[3]||(t[3]=e=>n(x).value.value=e),label:a.$t("explore.onSell"),"error-messages":n(x).errorMessage.value},null,8,["modelValue","label","error-messages"]),l(ge,{modelValue:n(V).value.value,"onUpdate:modelValue":t[4]||(t[4]=e=>n(V).value.value=e),label:a.$t("explore.description"),"error-messages":n(V).errorMessage.value},null,8,["modelValue","label","error-messages"]),l(u,{ref_key:"fileAgent",ref:C,modelValue:p.value,"onUpdate:modelValue":t[5]||(t[5]=e=>p.value=e),"raw-model-value":E.value,"onUpdate:rawModelValue":t[6]||(t[6]=e=>E.value=e),accept:"image/jpeg,image/png",deletable:"","max-size":"1MB","help-text":a.$t("fileAgent.helpText"),"error-text":{type:a.$t("fileAgent.errorType"),size:a.$t("fileAgent.errorSize")}},null,8,["modelValue","raw-model-value","help-text","error-text"])]),_:1}),l(ee,null,{default:o(()=>[l(b,{onClick:$},{default:o(()=>[m(d(a.$t("adminExplore.cancel")),1)]),_:1}),l(b,{type:"submit",loading:n(S)},{default:o(()=>[m(d(a.$t("adminExplore.submit")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1},8,["modelValue"])],64)}}};typeof T=="function"&&T(Ve);export{Ve as default};
